<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>타로 탄생번호 · 파스텔 버전</title>
<style>
  :root{
    --bg:#FAFAFE; --card:#FFFFFF; --ink:#222433; --muted:#6B6B7A;
    --accent:#6E65F4; --accent-2:#9E91FF; --ring:rgba(158,145,255,.28);
    --soft:#F4F2FF; --soft-2:#F8F7FF; --pill:#EFEAFF;
    --good:#4C3EF7;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', sans-serif;
    background: linear-gradient(180deg, #F7F5FF, #FAFAFE);
    color:var(--ink)
  }
  .wrap{max-width:980px; margin:0 auto; padding:28px 20px 48px}
  .hero{
    background: radial-gradient(1200px 400px at 50% -20%, #EFEAFF 0%, rgba(239,234,255,0) 70%);
    padding:12px 0 20px; text-align:center;
  }
  h1{
    margin:0 0 10px; font-size:32px; font-weight:900; letter-spacing:-.3px; line-height:1.2;
    background: linear-gradient(180deg,#4C3EF7 0%, #9E91FF 100%);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 1px 0 rgba(255,255,255,.6);
  }
  .sub{color:var(--muted); margin:0 auto 8px; max-width:640px}
  .panel{
    background:var(--card); border:1px solid #EFEFFD; border-radius:18px; padding:18px;
    box-shadow:0 10px 26px rgba(60,40,120,.06)
  }
  .controls{display:flex; gap:12px; justify-content:center; align-items:center; flex-wrap:wrap; margin:12px 0 8px}

  /* 3분할 날짜 입력 */
  .segdate{
    display:inline-flex; align-items:center; gap:6px;
    padding:10px 12px; border:1px solid #DDD7FF; border-radius:12px; background:#fff;
  }
  .segdate input{
    width:74px; /* 연도 */
    border:none; outline:none; font-size:16px; text-align:center; padding:6px 8px;
  }
  .segdate input#mm, .segdate input#dd{ width:54px; }
  .segdate span{ color:#8B86C9; font-weight:700; }
  .segdate:focus-within{ box-shadow:0 0 0 8px var(--ring); border-color:#CFC6FF; }

  button{
    padding:10px 14px; border:none; border-radius:10px; background:var(--accent); color:#fff;
    font-weight:800; cursor:pointer; letter-spacing:.2px
  }
  button:hover{filter:brightness(.97)}
  #share{background:var(--accent-2); display:none}

  .result{margin-top:16px; display:none}
  .grid{display:grid; grid-template-columns:1fr; gap:18px}
  @media (min-width:820px){ .grid{grid-template-columns: 1fr 1.35fr} } /* 타로 칸이 더 넓게 */

  .cardbox{background:var(--soft); border:1px solid #EEE8FF; border-radius:16px; padding:16px}
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .lpnum{font-size:54px; font-weight:900; color:var(--good); min-width:72px}
  .muted{color:var(--muted)}
  .k{font-weight:900}
  .keywords{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 8px}
  .kw{background:#F1EEFF; color:#4F46E5; border:1px solid #E6E0FF; padding:6px 10px; border-radius:999px; font-weight:700; font-size:13px}
  .desc{line-height:1.8}

  .tarot-pane{display:grid; grid-template-columns:160px 1fr; gap:16px; align-items:center}
  @media (max-width:520px){ .tarot-pane{grid-template-columns:1fr} }

  .imgframe{
    width:160px; height:252px; border-radius:14px;
    background:linear-gradient(180deg,#FFF,#F6F2FF);
    border:1px solid #EEE8FF; display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative
  }
  .imgframe img{width:100%; height:100%; object-fit:cover; display:block}
  .ph{display:flex; align-items:center; justify-content:center; text-align:center; padding:16px; color:#7B74B1}
  .ph .num{font-size:40px; font-weight:900; line-height:1}
  .ph .nm{font-weight:800; margin-top:6px}

  .footer{margin-top:24px; font-size:12px; color:var(--muted); text-align:center}
  .copybox{display:none; margin-top:10px; background:#F7F5FF; border:1px dashed #DAD1FF; border-radius:10px; padding:10px; color:#574F9A}
  code{background:#F3F1FF; padding:2px 6px; border-radius:6px}
</style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1>내 타로 탄생번호 & 라이프 패스</h1>
      <p class="sub">생일을 입력하면, 라이프 패스 넘버와 연결된 타로 메이저 아르카나가 자동으로 표시됩니다.</p>

      <div class="panel">
        <div class="controls">
          <!-- 3분할 날짜 입력 -->
          <div class="segdate" aria-label="생년월일">
            <input id="yy"  inputmode="numeric" pattern="\d*" maxlength="4" placeholder="YYYY" aria-label="연도 4자리" />
            <span>.</span>
            <input id="mm" inputmode="numeric" pattern="\d*" maxlength="2" placeholder="MM" aria-label="월 2자리" />
            <span>.</span>
            <input id="dd" inputmode="numeric" pattern="\d*" maxlength="2" placeholder="DD" aria-label="일 2자리" />
          </div>
          <button id="calc">계산하기</button>
          <button id="share">결과 링크 복사</button>
        </div>
        <p class="sub" id="hint">예) 2001.08.15</p>

        <div id="result" class="result">
          <div class="grid">
            <!-- 왼쪽: 라이프 패스 -->
            <div class="cardbox">
              <div class="row">
                <div class="lpnum" id="lpnum">–</div>
                <div>
                  <div><span class="k">라이프 패스 넘버</span> · <span id="lptext">—</span></div>
                  <div class="muted" id="doblabel"></div>
                </div>
              </div>
              <div class="keywords" id="lpchips"></div>
              <div class="desc" id="lp-plus">—</div>
              <div class="desc muted" id="lp-minus">—</div>
            </div>

            <!-- 오른쪽: 타로 카드 -->
            <div class="cardbox">
              <div class="tarot-pane">
                <div class="imgframe" id="imgframe">
                  <div class="ph" id="placeholder">
                    <div>
                      <div class="num" id="phnum">–</div>
                      <div class="nm" id="phname">카드</div>
                    </div>
                  </div>
                </div>
                <div>
                  <div class="k" id="tarotline">—</div>
                  <div class="keywords" id="keywords"></div>
                  <div class="desc" id="desc">—</div>
                  <div class="desc" id="synergy">—</div>
                </div>
              </div>
            </div>
          </div>

          <div class="copybox" id="copybox">결과 페이지 링크가 복사되었습니다. 어디든 붙여넣어 공유해보세요 😊</div>
        </div>
      </div>

      <div class="footer">
        카드 이미지를 넣으려면, 이 파일과 같은 폴더에 <code>cards/숫자.png</code> (예: <code>4.png</code>)를 추가하세요. <br/>
        바보 카드는 <code>0.png</code> 또는 <code>22.png</code>를 둘 다 지원합니다.
      </div>
    </div>
  </div>

<script>
/* 숫자 합, 한 자리(또는 11,22)로 줄이기 */
function sumDigits(str){ return str.split('').reduce((a,ch)=> a + (/\d/.test(ch)? Number(ch):0), 0); }
function reduceNumber(n){
  if (n===11 || n===22) return n;
  while(n>9){
    n = String(n).split('').reduce((a,b)=>a+Number(b),0);
    if (n===11 || n===22) break;
  }
  return n;
}

/* 타로 */
const TAROT = {
  0:{name:'바보 (The Fool)', num:'0/22', kw:['순수','도전','새 출발','자유'],
     desc:'틀을 깨고 새로운 여정을 시작하는 에너지. 계산보다 감각으로 첫 걸음을 내딛습니다.'},
  1:{name:'마법사 (The Magician)', num:'1', kw:['시작','창조','의지','실행'],
     desc:'머릿속의 아이디어를 현실로 불러오는 힘. “지금, 여기서” 실행이 답입니다.'},
  2:{name:'여사제 (High Priestess)', num:'2', kw:['직관','내면','비밀','지혜'],
     desc:'겉보다 속을 보는 눈. 조용하지만 정확한 통찰로 길을 선택합니다.'},
  3:{name:'여황제 (The Empress)', num:'3', kw:['풍요','창조성','돌봄','자연'],
     desc:'삶을 키우는 따뜻한 힘. 관계와 작업이 풍성해지는 시기입니다.'},
  4:{name:'황제 (The Emperor)', num:'4', kw:['구조','안정','책임','리더십'],
     desc:'토대를 세우고 지키는 힘. 지속 가능한 시스템을 만들 때 성과가 납니다.'},
  5:{name:'교황 (The Hierophant)', num:'5', kw:['전통','신뢰','가르침','멘토'],
     desc:'믿을 수 있는 길을 제시하는 안내자. 배우고 나누며 신뢰를 쌓습니다.'},
  6:{name:'연인 (The Lovers)', num:'6', kw:['사랑','선택','조화','관계'],
     desc:'중요한 선택의 순간. 마음과 가치가 일치하는 방향을 고르세요.'},
  7:{name:'전차 (The Chariot)', num:'7', kw:['의지','추진력','승리','집중'],
     desc:'흔들림 없이 밀어붙이는 힘. 속도보다 방향 유지가 승리의 핵심입니다.'},
  8:{name:'힘 (Strength)', num:'8', kw:['용기','인내','자기 통제'],
     desc:'부드러운 강함. 스스로를 다스릴 때 외부의 난관도 풀립니다.'},
  9:{name:'은둔자 (The Hermit)', num:'9', kw:['탐구','성찰','지혜','고독'],
     desc:'잠시 멈춰 등불을 켭니다. 혼자서의 시간이 해답을 비춥니다.'},
  10:{name:'운명의 수레바퀴 (Wheel of Fortune)', num:'10', kw:['변화','흐름','전환','기회'],
     desc:'올라가기도 내려가기도 하는 바퀴. 흐름을 읽으면 기회가 보입니다.'},
  11:{name:'정의 (Justice)', num:'11', kw:['균형','공정','진실','책임'],
     desc:'저울을 다시 맞춥니다. 선택에는 결과가 따릅니다.'},
  12:{name:'매달린 사람 (Hanged Man)', num:'12', kw:['관점 전환','멈춤','수용'],
     desc:'잠시 멈춰 다른 각도로 보기. 내려놓음이 역설적으로 진전을 만듭니다.'},
  13:{name:'죽음 (Death)', num:'13', kw:['종결','재탄생','큰 변화'],
     desc:'끝은 시작의 다른 이름. 낡은 것을 보내야 새것이 들어옵니다.'},
  14:{name:'절제 (Temperance)', num:'14', kw:['조화','중용','균형','치유'],
     desc:'섞고, 희석하고, 맞춥니다. 무리하지 않는 조합이 오랫동안 갑니다.'},
  15:{name:'악마 (The Devil)', num:'15', kw:['유혹','집착','패턴'],
     desc:'묶는 것은 사슬이 아니라 습관. 인식하면 절반은 풀렸습니다.'},
  16:{name:'탑 (The Tower)', num:'16', kw:['붕괴','각성','해방'],
     desc:'견고해 보였던 것이 무너질 때, 진짜 자유가 시작됩니다.'},
  17:{name:'별 (The Star)', num:'17', kw:['희망','영감','치유','비전'],
     desc:'먼 곳의 빛이 길을 가리킵니다. 서두르지 않아도 됩니다.'},
  18:{name:'달 (The Moon)', num:'18', kw:['무의식','불안','상상','직감'],
     desc:'안개 속 길. 두려움과 상상이 뒤섞입니다. 직감을 믿고 천천히.'},
  19:{name:'태양 (The Sun)', num:'19', kw:['성취','생명력','자신감','기쁨'],
     desc:'가장 밝은 카드. 마음껏 펼치고, 나누고, 축하하세요.'},
  20:{name:'심판 (Judgement)', num:'20', kw:['부름','회복','각성','새 삶'],
     desc:'깊은 곳에서 울리는 호출. 예전의 나를 넘어서는 순간입니다.'},
  21:{name:'세계 (The World)', num:'21', kw:['완성','통합','귀결','순환'],
     desc:'여정의 한 바퀴가 닫힙니다. 끝이자 다음 원의 시작입니다.'}
};

/* 라이프 패스(확장 설명) */
const LP = {
  1:{ label:'독립·개척·리더십',
    plus:['새 일을 밀어붙이는 추진력. 망설임보다 실행이 먼저라 스타트가 빠릅니다.',
          '결단이 필요할 때 중심을 잡고 리스크를 감수할 줄 압니다.'],
    minus:['혼자 속도를 내다 팀과 호흡이 어긋나기 쉬워요.',
           '끝까지 다지는 루틴이 약하면 마무리 품질이 떨어질 수 있습니다.'],
    synergy:'타로 1번 「마법사」와 겹치면 아이디어가 곧바로 행동으로 연결됩니다. MVP·테스트 론칭에 특히 강해요.'},
  2:{ label:'협력·감수성·조정',
    plus:['사람 사이의 미묘한 간격을 읽습니다. 분위기를 정리하고 조율하는 능력이 탁월해요.',
          '조용하지만 신뢰를 쌓는 대화와 경청이 강점입니다.'],
    minus:['선택을 미루거나 타인의 눈치를 보다 타이밍을 놓치기 쉽습니다.',
           '감정 소모가 누적되므로 에너지 관리가 필요합니다.'],
    synergy:'「여사제」와 만나면 직관과 공감이 정밀해져 협업이 매끄럽습니다. 리서치·인터뷰·상담 영역에서 빛납니다.'},
  3:{ label:'표현·창의·즐거움',
    plus:['말·글·디자인 등 표현이 살아납니다. 즐거움이 있는 작업에서 몰입이 생겨요.',
          '사람들을 편안하게 만들어 아이디어가 오가게 합니다.'],
    minus:['재미 위주로 흐르면 완성도가 흔들릴 수 있어요.',
           '감정 기복이 일정에 영향을 줄 수 있으니 가벼운 체크리스트를 유지하세요.'],
    synergy:'「여황제」와 연결되면 아이디어가 실물로 풍성하게 자랍니다. 브랜드·콘텐츠·커뮤니티에 유리합니다.'},
  4:{ label:'안정·성실·기반',
    plus:['구조화·프로세스·운영에 강합니다. 신뢰를 축적해 장기 성과를 만듭니다.',
          '리소스 관리와 표준화에 강해 조직의 허리를 단단히 합니다.'],
    minus:['변화를 경계해 기회를 지날 수 있습니다.',
           '규칙에만 의존하면 유연성이 떨어집니다. 작은 실험을 섞어 보세요.'],
    synergy:'「황제」와 합쳐지면 운영 체계가 명확해지고 확장성이 생깁니다. 매뉴얼화·QA·거버넌스에 강점.'},
  5:{ label:'변화·모험·자유',
    plus:['새로운 환경에 빠르게 적응합니다. 판을 바꾸는 전환 설계가 특기예요.',
          '호기심이 크고 배움-적용-공유의 사이클이 빠릅니다.'],
    minus:['루틴이 무너지면 체력이 먼저 소모됩니다.',
           '자극만 좇다 산만해질 수 있어 최소 일과를 고정하세요.'],
    synergy:'「교황」과 상보 관계. 전통 속에서 자유롭게 응용해 내공이 붙습니다. 교육·여행·신규 서비스 베타에 최적.'},
  6:{ label:'돌봄·책임·조화',
    plus:['사람과 일의 균형을 봅니다. 약속을 지키고 관계를 세심히 챙깁니다.',
          '고객 경험과 팀 케어에서 신뢰를 얻습니다.'],
    minus:['과도하게 떠맡아 번아웃 위험이 있어요.',
           '결정적 순간에 갈등을 피하면 방향이 흐려질 수 있습니다.'],
    synergy:'「연인」과 공명하면 가치가 맞는 파트너십에서 큰 성과를 냅니다. 서비스·CS·파트너 관리에 강점.'},
  7:{ label:'탐구·분석·집중',
    plus:['핵심 질문을 붙들고 깊이 파고듭니다. 본질을 명확히 하는 데 능숙해요.',
          '자료 정리·분석·검증에서 탁월한 정확도를 보입니다.'],
    minus:['혼자 고민만 깊어지면 속도가 느려집니다.',
           '완벽주의가 실행을 늦추니 80% 규칙을 활용해 보세요.'],
    synergy:'「전차」의 추진력이 더해지면 ‘깊이+속도’가 동시에 살아납니다. 전략·리서치·데이터 업무에 적합.'},
  8:{ label:'권위·성취·재정',
    plus:['목표-지표-성과를 구조화해 키웁니다. 운영과 수익화 설계에 강합니다.',
          '협상과 거버넌스 구축으로 팀의 방향을 단단히 맞춥니다.'],
    minus:['통제가 과하면 자율성이 떨어져 창의가 위축될 수 있어요.',
           '확장 타이밍을 잘못 잡으면 리스크가 커집니다.'],
    synergy:'「힘」과 만나면 ‘부드러운 통제’로 지속 가능한 성과를 냅니다. PM/운영 총괄에 강함.'},
  9:{ label:'포용·봉사·지혜',
    plus:['의미를 발견하고 나눕니다. 큐레이션·교육·멘토링에서 깊이가 드러나요.',
          '장기적 신뢰를 쌓는 데 유리합니다.'],
    minus:['이상만 추구하면 실행력이 떨어질 수 있어요.',
           '경계가 흐려지지 않게 역할과 범위를 분명히 하세요.'],
    synergy:'「은둔자」와 공명해 ‘내적 통찰→타인에게 비춘 등불’이 됩니다. 콘텐츠·상담·커뮤니티에 적합.'},
  11:{ label:'통찰·영감·직관',
    plus:['핵심을 정확히 짚어 메시지를 정제합니다. 균형 감각이 뛰어나요.',
          '복잡한 사안의 중심을 잡아 의사결정 기준을 세웁니다.'],
    minus:['완벽을 추구하다 실행이 지연될 수 있어요.',
           '감정 기복이 체력에 영향을 줍니다. 루틴·수면을 우선하세요.'],
    synergy:'「정의」와 연결되면 ‘진실로 균형 맞추기’에 강해집니다. 편집·정책·검증 단계에 강함.'},
  22:{ label:'대기획·구현·마스터 빌더',
    plus:['큰 비전을 실제 시스템으로 구현합니다. 복잡한 프로젝트를 설계·조율합니다.',
          '사람과 자원을 모아 장기 로드맵을 추진합니다.'],
    minus:['스케일만 키우면 과부하로 좌초할 수 있어요.',
           '작은 실행 단위를 과소평가하지 말고 단계화하세요.'],
    synergy:'0(바보)와 연결되면 ‘가볍게 시작→크게 구현’이 가능합니다. 플랫폼·인프라 구축에 최적.'}
};

/* 친절 문장(랜더링용) */
const EXPLAINS = {
  1:{ plus:"리드하고 앞장서는 기질입니다. 결단이 빠르고 추진력이 좋아 새 판을 여는 데 유리해요.",
      minus:"혼자 속도를 내다 협업 리듬이 어긋날 수 있어요. 마무리 루틴을 고정해 품질을 지키세요.",
      synergy:"{card}와(과) 함께면 ‘아이디어→실행’이 매우 빠르게 이어집니다. MVP·테스트 론칭에 강합니다." },
  2:{ plus:"사람 사이를 부드럽게 잇습니다. 경청과 배려로 신뢰를 쌓고 조정이 매끄러워요.",
      minus:"우유부단해 보일 수 있어요. 마감 전에는 ‘결정 타임’을 따로 두면 좋아요.",
      synergy:"{card}와(과) 만나면 직관·공감이 정밀해져 협업 효율이 높아집니다." },
  3:{ plus:"말·글·디자인 같은 표현력이 살아납니다. 즐거움이 있는 작업에 오래 몰입해요.",
      minus:"흥미 위주가 되면 마무리가 느슨해질 수 있어요. 체크리스트로 속도를 유지하세요.",
      synergy:"{card}와(과) 함께면 아이디어가 실제 결과물로 풍성해집니다." },
  4:{ plus:"구조와 시스템을 만드는 힘. 꾸준함으로 신뢰를 장기적으로 쌓습니다.",
      minus:"변화에 보수적일 수 있어요. 작은 실험을 섞어 안정 속 유연성을 확보하세요.",
      synergy:"{card}와(과) 합쳐지면 운영·표준화·확장성에서 강점을 보입니다." },
  5:{ plus:"새로운 환경에 빠르게 적응하고 전환을 설계합니다. 배우고 적용하고 공유하는 사이클이 빨라요.",
      minus:"루틴이 쉽게 무너지니 최소 일과를 고정하세요.",
      synergy:"{card}와(과) 만나면 ‘배움→전파’의 흐름이 좋아집니다. 파일럿·여행·교육에 유리합니다." },
  6:{ plus:"관계와 팀의 균형을 세심하게 챙깁니다. 약속을 지켜 신뢰를 얻어요.",
      minus:"과도한 책임으로 지치기 쉬워요. 경계와 역할을 분명히 하세요.",
      synergy:"{card}와(과) 함께면 가치가 맞는 파트너십에서 큰 성과가 납니다." },
  7:{ plus:"핵심 질문을 놓치지 않고 깊이 파고듭니다. 분석과 검증에서 정확도가 높아요.",
      minus:"고립되면 속도가 떨어져요. 주기적으로 외부 피드백을 받으세요.",
      synergy:"{card}와(과) 연결되면 ‘깊이+속도’가 동시에 살아납니다." },
  8:{ plus:"목표·지표·성과를 구조화해 키웁니다. 재정·운영·협상에서 힘을 발휘해요.",
      minus:"통제가 과하면 팀의 자율성이 줄어들 수 있어요. 위임 룰을 정해 보세요.",
      synergy:"{card}와(과) 만나면 ‘부드러운 통제’로 지속 가능한 성과를 냅니다." },
  9:{ plus:"의미를 찾아 나누는 힘. 큐레이션·교육·상담에서 깊이가 드러나요.",
      minus:"현실 디테일을 놓칠 수 있어 체크리스트가 필요합니다.",
      synergy:"{card}와(과) 함께면 ‘내적 통찰→등불’이 됩니다. 커뮤니티·멘토링에 적합." },
  11:{ plus:"한 끗을 꿰뚫는 통찰과 균형 감각. 복잡한 사안의 중심을 잡아요.",
      minus:"완벽주의로 실행이 지연될 수 있습니다. 80% 룰로 출발점을 앞당기세요.",
      synergy:"{card}와(과) 만나면 ‘진실로 균형 맞추기’가 핵심이 됩니다." },
  22:{ plus:"큰 비전을 실제 시스템으로 구현합니다. 복잡한 프로젝트를 설계·조율해 완주합니다.",
      minus:"스케일만 키우면 과부하가 옵니다. 단계를 잘게 나눠 리스크를 분산하세요.",
      synergy:"{card}와(과) 함께면 ‘가볍게 시작→크게 실현’의 흐름이 만들어집니다." }
};
const EXPLAINS_FALLBACK = {
  plus:"강점이 선명해지는 흐름입니다. 당신의 방식으로 길을 냅니다.",
  minus:"과로·조급함을 피하고 리듬을 지키면 성과가 안정적입니다.",
  synergy:"{card}와(과) 연결되며 새로운 전환이 열립니다."
};

/* 이미지 로더 */
function tryLoadImage(numList){
  return new Promise((resolve)=>{
    const frame = document.getElementById('imgframe');
    const ph = document.getElementById('placeholder');
    const old = frame.querySelector('img'); if(old) old.remove();
    function next(i){
      if(i>=numList.length){ ph.style.display='flex'; return resolve(false); }
      const src = 'cards/' + numList[i] + '.png';
      const img = new Image();
      img.onload = ()=>{ ph.style.display='none'; frame.appendChild(img); resolve(true); };
      img.onerror = ()=> next(i+1);
      img.src = src;
    }
    next(0);
  });
}

/* 계산/렌더 */
function calc(dobStr){
  const sum = dobStr ? sumDigits(dobStr) : 0;
  const lifePath = reduceNumber(sum);
  const tarot = (lifePath===22) ? TAROT[0] : TAROT[lifePath];
  return {lifePath, tarot};
}

function render(dob){
  const result = document.getElementById('result');
  const lpnum = document.getElementById('lpnum');
  const lptext = document.getElementById('lptext');
  const lpchips = document.getElementById('lpchips');
  const doblabel = document.getElementById('doblabel');
  const lpPlus = document.getElementById('lp-plus');
  const lpMinus = document.getElementById('lp-minus');
  const synergy = document.getElementById('synergy');
  const tarotline = document.getElementById('tarotline');
  const keywords = document.getElementById('keywords');
  const desc = document.getElementById('desc');
  const phnum = document.getElementById('phnum');
  const phname = document.getElementById('phname');
  const shareBtn = document.getElementById('share');
  const copybox = document.getElementById('copybox');

  const {lifePath, tarot} = calc(dob);
  result.style.display = 'block';
  copybox.style.display = 'none';

  lpnum.textContent = lifePath;
  const lp = LP[lifePath];
  lptext.textContent = lp ? lp.label : '—';
  doblabel.textContent = '생일: ' + dob;

  lpchips.innerHTML = '';
  (lp?.label || '').split('·').forEach(t=>{
    if(!t.trim()) return;
    const s=document.createElement('span'); s.className='kw'; s.textContent=t.trim(); lpchips.appendChild(s);
  });

  const ex = EXPLAINS[lifePath] || EXPLAINS_FALLBACK;
  lpPlus.textContent  = ex.plus;
  lpMinus.textContent = ex.minus;

  tarotline.textContent = tarot ? (tarot.name + ' · 카드 번호 ' + tarot.num) : '—';
  keywords.innerHTML = '';
  (tarot?.kw || []).forEach(k=>{
    const s=document.createElement('span'); s.className='kw'; s.textContent=k; keywords.appendChild(s);
  });
  desc.textContent = tarot?.desc || '—';
  synergy.textContent = (ex.synergy || '').replaceAll('{card}', tarot?.name || '해당 카드');

  phnum.textContent = tarot?.num || '–';
  phname.textContent = tarot?.name || '카드';

  const nums = (lifePath===22) ? [0,22] : [lifePath];
  tryLoadImage(nums);

  shareBtn.style.display = 'inline-block';
  history.replaceState({}, '', location.pathname + '?dob=' + dob);
}

/* 공유 */
function onShare(){
  const copybox = document.getElementById('copybox');
  const url = location.href;
  navigator.clipboard?.writeText(url).then(()=>{
    copybox.style.display='block';
    setTimeout(()=> copybox.style.display='none', 2000);
  }).catch(()=> alert('클립보드 복사가 지원되지 않아요. 주소창 링크를 직접 복사해 주세요.'));
}

/* 메인: 3분할 입력 & 자동 포커스 */
function main(){
  const yy = document.getElementById('yy');
  const mm = document.getElementById('mm');
  const dd = document.getElementById('dd');
  const btn = document.getElementById('calc');
  const shareBtn = document.getElementById('share');

  const segs = [yy, mm, dd];
  segs.forEach((el, i) => {
    el.addEventListener('input', () => {
      const max = (i===0)? 4 : 2;
      el.value = el.value.replace(/\D/g,'').slice(0, max);
      if (el.value.length === max && i < segs.length - 1) segs[i+1].focus();
    });
  });

  const params = new URLSearchParams(location.search);
  const dobQ = params.get('dob');
  if(dobQ && /^\d{4}-\d{2}-\d{2}$/.test(dobQ)){
    yy.value = dobQ.slice(0,4);
    mm.value = dobQ.slice(5,7);
    dd.value = dobQ.slice(8,10);
    render(dobQ);
  }

  btn.addEventListener('click', ()=>{
    const y = yy.value.trim(), m = mm.value.trim(), d = dd.value.trim();
    if (y.length!==4 || m.length!==2 || d.length!==2){
      alert('생년월일을 정확히 입력해 주세요.\n(예: 2001·08·15)'); return;
    }
    const dob = `${y}-${m}-${d}`;
    const t = new Date(dob);
    if (isNaN(t.getTime()) || t.getFullYear()!=+y || (t.getMonth()+1)!=+m || t.getDate()!=+d){
      alert('유효한 날짜가 아니에요. 다시 확인해 주세요.'); return;
    }
    render(dob);
  });

  shareBtn.addEventListener('click', onShare);
}
main();
</script>
</body>
</html>
