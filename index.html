<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>내 타로 탄생번호 & 라이프 패스</title>
<style>
  :root{
    --bg:#F7F5FF; --bg2:#FAFAFE; --card:#FFFFFF; --ink:#222433; --muted:#6E6B7A;
    --accent:#6E65F4; --accent2:#9E91FF; --ring:rgba(158,145,255,.28);
    --soft:#F4F2FF; --soft2:#F8F7FF; --pill:#EFEAFF;
    --good:#4C3EF7; --border:#EEE8FF; --ok:#4F46E5; --warn:#9C7CF9;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family: ui-sans-serif,-apple-system,Segoe UI,Roboto,'Noto Sans KR',sans-serif;
       background:linear-gradient(180deg,var(--bg),var(--bg2)); color:var(--ink)}
  .wrap{max-width:980px; margin:0 auto; padding:28px 18px 40px}
  .hero{padding:6px 0 18px; text-align:center}
  .title{
    font-weight:900; font-size:30px; line-height:1.15; margin:10px 0 8px;
    background:linear-gradient(90deg,var(--accent),var(--accent2));
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  }
  .sub{color:var(--muted); margin:0 auto 12px; max-width:680px}
  .panel{background:var(--card); border:1px solid var(--border); border-radius:18px; padding:18px;
         box-shadow:0 10px 26px rgba(60,40,120,.06)}
  .controls{display:flex; gap:8px; justify-content:center; align-items:center; flex-wrap:wrap}
  .seg{display:flex; gap:8px; align-items:center}
  input.segitem{width:84px; padding:10px 12px; border:1px solid #DDD7FF; border-radius:10px; outline:none;
                font-size:16px; text-align:center; background:#fff}
  input.segitem:focus{box-shadow:0 0 0 8px var(--ring); border-color:#CFC6FF}
  button{padding:10px 14px; border:none; border-radius:11px; background:var(--accent); color:#fff;
         font-weight:800; cursor:pointer; letter-spacing:.2px}
  button:hover{filter:brightness(.97)}
  #share{background:var(--accent2)}
  .hint{color:var(--muted); margin-top:8px; text-align:center}
  .result{margin-top:16px; display:none}
  .grid{display:grid; grid-template-columns: 1.02fr 1.18fr; gap:16px}
  @media (max-width:860px){ .grid{grid-template-columns:1fr} }
  .cardbox{background:var(--soft); border:1px solid var(--border); border-radius:16px; padding:16px}
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .lpnum{font-size:44px; font-weight:900; color:var(--good); min-width:72px}
  .muted{color:var(--muted)}
  .k{font-weight:900}
  .badge{display:inline-block; padding:6px 10px; border-radius:999px; background:#F1EEFF; color:#4F46E5;
         border:1px solid #E6E0FF; font-weight:700; font-size:13px; margin-right:6px; margin-top:4px}
  .chip{display:inline-block; padding:4px 8px; border-radius:999px; font-weight:800; font-size:12px}
  .chip.ok{background:#ECE9FF; color:var(--ok); border:1px solid var(--border)}
  .chip.warn{background:#F2EDFF; color:#5A4FE3; border:1px dashed #D5CCFF}
  .desc{line-height:1.85}
  .desc + .desc{margin-top:6px}
  .tarot-pane{display:grid; grid-template-columns:140px 1fr; gap:14px; align-items:center}
  @media (max-width:520px){ .tarot-pane{grid-template-columns:1fr} }
  .imgframe{width:140px; height:220px; border-radius:14px; background:linear-gradient(180deg,#FFF,#F6F2FF);
            border:1px solid var(--border); display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative}
  .imgframe img{width:100%; height:100%; object-fit:cover; display:block}
  .ph{display:flex; align-items:center; justify-content:center; text-align:center; padding:16px; color:#7B74B1}
  .ph .num{font-size:40px; font-weight:900; line-height:1}
  .ph .nm{font-weight:800; margin-top:6px}
  .copy{display:none; margin-top:10px; background:#F7F5FF; border:1px dashed #DAD1FF; border-radius:10px; padding:10px; color:#574F9A}
  .synergy{margin-top:16px; background:var(--soft2); border:1px solid var(--border); border-radius:14px; padding:14px 16px}
  .synergy .title2{font-weight:900; margin:0 0 6px}
  .footer{margin-top:18px; font-size:12px; color:var(--muted); text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1 class="title">내 타로 탄생번호 & 라이프 패스</h1>
      <p class="sub">생일을 입력하면, 라이프 패스 넘버와 연결된 타로 메이저 아르카나가 자동으로 표시됩니다.</p>
      <div class="panel">
        <div class="controls">
          <div class="seg">
            <input class="segitem" id="yy" inputmode="numeric" maxlength="4" placeholder="YYYY" aria-label="연도">
            <span>·</span>
            <input class="segitem" id="mm" inputmode="numeric" maxlength="2" placeholder="MM" aria-label="월">
            <span>·</span>
            <input class="segitem" id="dd" inputmode="numeric" maxlength="2" placeholder="DD" aria-label="일">
          </div>
          <button id="calc">계산하기</button>
          <button id="share">결과 링크 복사</button>
        </div>
        <div class="hint">예) 2001·08·15</div>

        <div id="result" class="result">
          <div class="grid">
            <!-- 수비학 -->
            <div class="cardbox">
              <div class="row" style="margin-bottom:6px">
                <div class="lpnum" id="lpnum">–</div>
                <div>
                  <div><span class="k">라이프 패스 넘버</span> · <span id="lptext">—</span></div>
                  <div class="muted" id="doblabel"></div>
                </div>
              </div>
              <div id="lp-badges"></div>
              <div style="margin-top:8px">
                <span class="chip ok">강점</span>
                <div class="desc" id="lp-plus"></div>
              </div>
              <div style="margin-top:10px">
                <span class="chip warn">주의</span>
                <div class="desc muted" id="lp-minus"></div>
              </div>
            </div>

            <!-- 타로 -->
            <div class="cardbox">
              <div class="tarot-pane">
                <div class="imgframe" id="imgframe">
                  <div class="ph" id="placeholder">
                    <div>
                      <div class="num" id="phnum">–</div>
                      <div class="nm" id="phname">카드</div>
                    </div>
                  </div>
                </div>
                <div>
                  <div class="k" id="tarotline">—</div>
                  <div id="tarot-badges" style="margin:6px 0 6px"></div>
                  <div class="desc" id="desc">—</div>
                  <div class="desc" id="desc2"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- 시너지: 두 박스 밖, 아래에 분리 -->
          <div class="synergy" id="synergyBox" style="display:none">
            <div class="title2" id="synTitle">시너지</div>
            <div id="synBody" class="desc"></div>
          </div>

          <div class="copy" id="copybox">결과 링크가 복사되었습니다. 어디든 붙여넣어 공유하세요 😊</div>
          <div class="footer">카드 이미지를 넣으려면 이 파일과 같은 폴더에 <code>cards/숫자.png</code>를 추가하세요 (예: <code>4.png</code>). 바보 카드는 <code>0.png</code> 또는 <code>22.png</code>를 둘 다 지원합니다.</div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ---------- 유틸 ---------- */
function sumDigits(str){ return str.split('').reduce((a,ch)=> a + (/\d/.test(ch)? Number(ch):0), 0); }
function reduceNumber(n){
  if (n===11 || n===22) return n;
  while(n>9){
    n = String(n).split('').reduce((a,b)=>a+Number(b),0);
    if (n===11 || n===22) break;
  }
  return n;
}

/* ---------- 타로 카드 데이터 : 본문을 조금 더 풍성하게(2문단) ---------- */
const TAROT = {
  0:{name:'바보 (The Fool)', num:'0/22', kw:['순수','도전','새 출발','자유'],
     desc:'마음이 먼저 움직이는 시간. 아직 정답은 없어도 “가볍게 시작”하면 길이 열립니다.',
     desc2:'완벽한 계획보다 작은 시도가 더 멀리 데려다줘요. 호기심을 따라가며 경험을 수집해 보세요.'},
  1:{name:'마법사 (The Magician)', num:'1', kw:['시작','창조','의지','실행'],
     desc:'머릿속 재료를 현실로 소환하는 조율자. 도구·메시지·타이밍을 한 점으로 모읍니다.',
     desc2:'핵심은 즉시성. 오늘 가능한 최소 실행을 정하고, 작은 성과를 연속으로 쌓아가면 좋아요.'},
  2:{name:'여사제 (High Priestess)', num:'2', kw:['직관','내면','비밀','지혜'],
     desc:'겉보다 속, 말보다 사이. 조용한 관찰이 방향을 정합니다.',
     desc2:'정보를 더 모을 필요가 있거나, 잠깐의 쉼이 답이 되는 때. 직감의 미세한 신호를 믿어 주세요.'},
  3:{name:'여황제 (The Empress)', num:'3', kw:['풍요','창조성','돌봄','자연'],
     desc:'무르익는 계절. 관계와 작업이 자연스레 풍성해집니다.',
     desc2:'생활 리듬을 돌볼수록 결과물의 질도 좋아져요. 정성·꾸준함·따뜻함이 최고의 성장 비료입니다.'},
  4:{name:'황제 (The Emperor)', num:'4', kw:['구조','안정','책임','리더십'],
     desc:'토대와 질서, 명확한 결정. 기준을 세우면 에너지가 낭비되지 않습니다.',
     desc2:'장기 운영·거버넌스에 강점. 역할과 권한을 정리하면 팀이 편안해집니다.'},
  5:{name:'교황 (The Hierophant)', num:'5', kw:['전통','신뢰','가르침','멘토'],
     desc:'검증된 길과 지식의 전수. 배우고 나누며 신뢰를 쌓습니다.',
     desc2:'원칙을 손에 쥐고 응용하면 흔들리지 않아요. 멘토/커뮤니티와 연결해 보세요.'},
  6:{name:'연인 (The Lovers)', num:'6', kw:['사랑','선택','조화','관계'],
     desc:'무엇을 하느냐 못지않게 누구와 하느냐가 중요. 마음과 가치가 맞는 선택을.',
     desc2:'관계의 질이 성과의 질을 만듭니다. 서로의 “예/아니오”를 존중하는 합이 필요해요.'},
  7:{name:'전차 (The Chariot)', num:'7', kw:['의지','추진력','승리','집중'],
     desc:'방향이 정해지면 속도는 자연스럽게 붙습니다. 방해 요소를 정리하고 한 점으로 모으세요.',
     desc2:'집중 근육을 단기간에 키우는 때. 적은 목표를 빠르게 완주하면 자신감이 크게 오릅니다.'},
  8:{name:'힘 (Strength)', num:'8', kw:['용기','인내','자기 통제'],
     desc:'부드러운 통제가 단단한 힘이 됩니다. 스스로를 다스릴 때 외부의 난관도 풀려요.',
     desc2:'꾸준함·회복력이 핵심. 감정의 파동을 천천히 진정시키며 페이스를 지켜 보세요.'},
  9:{name:'은둔자 (The Hermit)', num:'9', kw:['탐구','성찰','지혜','고독'],
     desc:'혼자만의 등이 필요합니다. 번잡을 덜어내면 통찰이 또렷해져요.',
     desc2:'기록과 사유가 큰 힘이 됩니다. 조용한 몰입의 시간을 스스로에게 선물하세요.'},
  10:{name:'운명의 수레바퀴 (Wheel of Fortune)', num:'10', kw:['변화','흐름','전환','기회'],
     desc:'흐름에 올라타는 지점이 보입니다. 집착을 내려놓을수록 문이 열려요.',
     desc2:'작은 징후를 놓치지 마세요. 타이밍만 맞아도 성과가 가볍게 굴러갑니다.'},
  11:{name:'정의 (Justice)', num:'11', kw:['균형','공정','진실','책임'],
     desc:'사실과 기준을 또렷이. 불균형을 바로잡고 결과에 책임집니다.',
     desc2:'감정과 사실을 분리하면 해결이 보입니다. 계약·정산·의사결정에 유리한 시기.'},
  12:{name:'매달린 사람 (Hanged Man)', num:'12', kw:['관점 전환','멈춤','수용'],
     desc:'서두르지 않는 용기. 방향을 바꾸면 답이 달라집니다.',
     desc2:'내려놓음이 역설적으로 진전을 만듭니다. 여유를 허락해 주세요.'},
  13:{name:'죽음 (Death)', num:'13', kw:['종결','재탄생','큰 변화'],
     desc:'낡은 것을 보내 새 길을 엽니다. 끝은 시작의 다른 이름.',
     desc2:'과감한 정리가 곧 성장의 공간이 됩니다. 비워야 들어와요.'},
  14:{name:'절제 (Temperance)', num:'14', kw:['중용','균형','치유','조화'],
     desc:'섞고 희석하며 비율을 맞추는 연금술. 무리하지 않는 조합이 오래갑니다.',
     desc2:'페이스 관리·휴식·물 마시기가 생각보다 큰 변화를 줍니다.'},
  15:{name:'악마 (The Devil)', num:'15', kw:['유혹','집착','패턴'],
     desc:'묶는 것은 사슬이 아니라 습관. 인식하면 절반은 풀렸습니다.',
     desc2:'“즐거움/성과”의 비율을 다시 점검하세요. 원하는 방향으로 조정이 가능합니다.'},
  16:{name:'탑 (The Tower)', num:'16', kw:['붕괴','각성','해방'],
     desc:'무너지는 틀 속에서 진짜 자유가 시작됩니다.',
     desc2:'위기를 “오래된 오류 수정”으로 보면 마음이 가벼워져요. 새 구조를 차분히 세워 봅시다.'},
  17:{name:'별 (The Star)', num:'17', kw:['희망','영감','치유','비전'],
     desc:'먼 곳의 빛이 길을 가리킵니다. 당장은 느려도 방향이 맞습니다.',
     desc2:'투명함과 회복이 성과를 부릅니다. 마음을 정비하고 다시 믿어 주세요.'},
  18:{name:'달 (The Moon)', num:'18', kw:['무의식','불안','상상','직감'],
     desc:'안개 속 길. 불확실함을 인정할수록 두려움이 줄어요.',
     desc2:'큰 결정은 잠시 미루고 작은 확인을 쌓으세요. 꿈·메모가 단서가 됩니다.'},
  19:{name:'태양 (The Sun)', num:'19', kw:['성취','생명력','자신감','기쁨'],
     desc:'가장 밝은 카드. 마음껏 펼치고, 나누고, 축하하세요.',
     desc2:'드러냄이 곧 확장. 당신의 기쁨이 주변을 환하게 비춥니다.'},
  20:{name:'심판 (Judgement)', num:'20', kw:['부름','회복','각성','새 삶'],
     desc:'깊은 곳에서 울리는 호출. 예전의 나를 넘어서는 순간.',
     desc2:'정리–회복–재시작의 박자를 타세요. 진심이 사람을 일으킵니다.'},
  21:{name:'세계 (The World)', num:'21', kw:['완성','통합','귀결','순환'],
     desc:'한 바퀴의 완성. 끝이자 다음 원의 시작.',
     desc2:'경험이 통합될수록 다음 여정의 자본이 됩니다. 수고했다는 인사도 잊지 말기!'}
};

/* ---------- 라이프 패스 프로필 + 시너지 문구(조금 더 길고 따뜻하게) ---------- */
const LP = {
  1:{label:'독립·개척·리더십', tags:['리더십','개척','결단'],
     plus:'새 길을 내는 추진력이 강합니다. 사람들을 설득하고 앞장서서 방향을 잡는 일이 잘 맞아요. “먼저 시작”에서 성과가 납니다.',
     minus:'빠른 판단이 때로는 독단처럼 보일 수 있어요. 협업·마무리 단계는 체크리스트로 천천히 확인해 주세요.',
     synergy:'{card}와(과) 만나면 아이디어가 바로 실행으로 이어집니다. 1인 프로젝트·창업·선도적 시도에서 가볍게 시동 걸고 빠르게 성과를 확인할 수 있어요.'},
  2:{label:'협력·감수성·조정', tags:['협업','조율','관찰'],
     plus:'상대의 속도와 감정선을 잘 읽어 다리가 되어 줍니다. 팀의 긴장을 낮추고 안정적인 흐름을 만드는 재능이 커요.',
     minus:'결정을 미루다 기회를 놓치기 쉬워요. “내 기준”을 한 줄로 정해 두면 속도가 붙습니다.',
     synergy:'{card}와(과) 함께라면 관찰·직관의 정밀도가 높아집니다. 초반 리서치·검증 단계에서 매끄럽게 합을 맞추며 신뢰를 얻습니다.'},
  3:{label:'표현·창의·즐거움', tags:['표현','창의','즐거움'],
     plus:'말·글·디자인 같은 표현력이 풍부합니다. 사람을 기분 좋게 만드는 에너지가 있어요. 즐거움 기반의 창작에서 영향력이 커집니다.',
     minus:'흥미가 옮겨 다니면 완성도가 흐트러질 수 있어요. 작은 목표·주간 리듬으로 작업을 다독여 주세요.',
     synergy:'{card}와(과) 만나면 아이디어가 실제 “성과물”로 풍성하게 자랍니다. 콘텐츠·브랜딩·커뮤니티 영역에서 존재감이 커지고 수익화의 실마리도 잡힙니다.'},
  4:{label:'안정·성실·기반', tags:['기반','관리','꾸준함'],
     plus:'루틴과 시스템을 세우고 지키는 힘. 신뢰를 차곡차곡 쌓는 타입입니다. 장기 운영·표준화에 강점이 있어요.',
     minus:'급격한 변화에는 둔감해질 수 있어요. 안전 레일을 만든 뒤 작은 실험부터 시작해 보세요.',
     synergy:'{card}와(과) 함께라면 “튼튼한 기반 위의 확장”이 빨라집니다. 운영·매뉴얼·브랜딩에서 안정감 있는 성과가 나옵니다.'},
  5:{label:'변화·모험·자유', tags:['전환','실험','확장'],
     plus:'새 판을 빠르게 이해하고 적응합니다. 배움과 여행, 다양한 경험에서 영감이 샘처럼 올라와요.',
     minus:'루틴이 쉽게 무너질 수 있어요. 핵심 지표 1~2개만 붙잡고 집중도를 유지해 보세요.',
     synergy:'{card}와(과) 결합하면 배움과 전파의 흐름이 시원하게 열립니다. 교육·여행·새 서비스 베타 론칭에 딱 좋아요.'},
  6:{label:'돌봄·책임·조화', tags:['돌봄','책임','조화'],
     plus:'관계의 균형을 맞추고 책임을 다합니다. 팀/고객 경험을 정성껏 가꾸는 능력이 커요.',
     minus:'과잉 책임으로 번아웃 되기 쉬워요. 경계·분담을 명확히 정하고 나눠 갖는 연습을 해 보세요.',
     synergy:'{card}와(과) 만나면 “가치 정렬된 파트너십”이 성과를 이끌어 냅니다. 관계가 곧 시스템이 되는 경험을 하게 됩니다.'},
  7:{label:'탐구·분석·집중', tags:['탐구','분석','집중'],
     plus:'본질을 파고드는 연구형 기질. 문제의 핵심을 정확히 찾아냅니다.',
     minus:'완벽주의와 고립으로 속도가 느려질 수 있어요. 작은 실험–피드백 루프를 짧게 가져가면 좋아요.',
     synergy:'{card}의 추진력과 합쳐지면 “깊이+속도”가 동시에 살아납니다. 전략·데이터·분석 프로젝트에 특히 유리합니다.'},
  8:{label:'권위·성취·재정', tags:['권위','성과','재정'],
     plus:'목표 달성과 수익화에 강합니다. 과정을 구조화하고 성장시키는 운영 능력이 있어요.',
     minus:'통제가 과하면 팀의 자율성이 떨어질 수 있어요. 원칙은 단단하게, 실행은 유연하게 가져가 보세요.',
     synergy:'{card}와(과) 함께라면 “부드러운 통제”로 지속 가능한 성과 관리가 가능합니다. 협상·운영 총괄·스케일업에 강합니다.'},
  9:{label:'포용·봉사·지혜', tags:['포용','의미','치유'],
     plus:'사람과 이야기를 깊이 이해하고 품어 줍니다. 큰 그림에서 의미를 찾아 전하는 재능이 커요.',
     minus:'현실 디테일과 수익성이 약해질 수 있어요. 역할과 범위를 명확히 해 두면 편안합니다.',
     synergy:'{card}와(과) 결합하면 “내적 통찰이 빛이 되어” 콘텐츠·멘토링·큐레이션에서 영향력이 커집니다.'},
  11:{label:'통찰·영감·균형', tags:['통찰','균형','진실'],
     plus:'한 끗 차이를 꿰뚫는 눈. 공정한 기준으로 상황을 정리합니다.',
     minus:'완벽주의·자기검열이 실행을 늦출 수 있어요. 80% 출고·지속 개선을 습관화해 보세요.',
     synergy:'{card}와(과) 공명하면 “진실로 균형 맞추기”가 또렷해집니다. 의사결정·검증·편집에서 강한 결과가 납니다.'},
  22:{label:'대기획·구현·마스터 빌더', tags:['설계','구현','스케일'],
     plus:'큰 비전을 실제 시스템으로 구현합니다. 장기 로드맵·플랫폼 설계에 강해요.',
     minus:'스케일만 키우다 과부하가 올 수 있어요. 파트 관리와 리스크 분산을 먼저 설계해 주세요.',
     synergy:'{card}와(과) 만나면 “가볍게 시작→거대한 실현”의 흐름이 가능해집니다. 대형 프로젝트·플랫폼 구축에서 완주력이 생깁니다.'}
};

/* ---------- 계산/렌더 ---------- */
function calc(dobStr){
  const sum = dobStr ? sumDigits(dobStr) : 0;
  const lifePath = reduceNumber(sum);
  const tarot = (lifePath===22) ? TAROT[0] : TAROT[lifePath];
  return {lifePath, tarot};
}

function tryLoadImage(numList){
  return new Promise((resolve)=>{
    const frame = document.getElementById('imgframe');
    const ph = document.getElementById('placeholder');
    const old = frame.querySelector('img'); if(old) old.remove();
    function next(i){
      if(i>=numList.length){ ph.style.display='flex'; return resolve(false); }
      const src = 'cards/' + numList[i] + '.png';
      const img = new Image();
      img.onload = ()=>{ ph.style.display='none'; frame.appendChild(img); resolve(true); };
      img.onerror = ()=> next(i+1);
      img.src = src;
    }
    next(0);
  });
}

function render(dob){
  const result = document.getElementById('result');
  const lpnum = document.getElementById('lpnum');
  const lptext = document.getElementById('lptext');
  const doblabel = document.getElementById('doblabel');
  const lpplus = document.getElementById('lp-plus');
  const lpminus = document.getElementById('lp-minus');
  const lpBadges = document.getElementById('lp-badges');

  const tarotline = document.getElementById('tarotline');
  const tarotBadges = document.getElementById('tarot-badges');
  const desc = document.getElementById('desc');
  const desc2 = document.getElementById('desc2');
  const phnum = document.getElementById('phnum');
  const phname = document.getElementById('phname');

  const synBox = document.getElementById('synergyBox');
  const synTitle = document.getElementById('synTitle');
  const synBody = document.getElementById('synBody');

  const {lifePath, tarot} = calc(dob);
  result.style.display = 'block';

  // LP
  const profile = LP[lifePath];
  lpnum.textContent = lifePath;
  lptext.textContent = profile?.label || '—';
  doblabel.textContent = '생일: ' + dob;

  lpBadges.innerHTML = '';
  (profile?.tags || []).forEach(t=>{
    const b=document.createElement('span'); b.className='badge'; b.textContent=t; lpBadges.appendChild(b);
  });
  lpplus.textContent  = profile?.plus || '—';
  lpminus.textContent = profile?.minus || '—';

  // Tarot
  tarotline.textContent = tarot ? (tarot.name + ' · 카드 번호 ' + tarot.num) : '—';
  tarotBadges.innerHTML='';
  (tarot?.kw || []).forEach(k=>{
    const b=document.createElement('span'); b.className='badge'; b.textContent=k; tarotBadges.appendChild(b);
  });
  desc.textContent = tarot?.desc || '—';
  desc2.textContent = tarot?.desc2 || '';
  phnum.textContent = tarot?.num || '–';
  phname.textContent = tarot?.name || '카드';

  // Image
  const nums = (lifePath===22) ? [0,22] : [lifePath];
  tryLoadImage(nums);

  // Synergy (두 박스 밖)
  const syn = (profile?.synergy || '').replaceAll('{card}', tarot?.name || '해당 카드');
  if(syn){
    synTitle.textContent = `시너지: 라이프 패스 ${lifePath} × ${tarot?.name || ''}`;
    synBody.textContent = syn;
    synBox.style.display = 'block';
  }else{
    synBox.style.display = 'none';
  }

  // URL 갱신
  history.replaceState({}, '', location.pathname + '?dob=' + dob);
}

/* ---------- 공유 ---------- */
function onShare(){
  const url = location.href;
  const copybox = document.getElementById('copybox');
  navigator.clipboard?.writeText(url).then(()=>{
    copybox.style.display='block';
    setTimeout(()=> copybox.style.display='none', 1600);
  }).catch(()=> alert('클립보드 복사가 지원되지 않아요. 주소창 링크를 직접 복사해 주세요.'));
}

/* ---------- 입력 UX: 자동 포커스 이동 ---------- */
function pad2(n){ return String(n).padStart(2,'0'); }
function main(){
  const yy=document.getElementById('yy'), mm=document.getElementById('mm'), dd=document.getElementById('dd');
  const btn=document.getElementById('calc'), shareBtn=document.getElementById('share');

  // 자동 자리수 채움 & 포커스 이동
  const segs=[yy,mm,dd];
  segs.forEach((el,i)=>{
    el.addEventListener('input',()=>{
      const max = i===0 ? 4 : 2;
      el.value = el.value.replace(/[^\d]/g,'').slice(0,max);
      if(el.value.length===max && i<segs.length-1){ segs[i+1].focus(); }
    });
  });

  // URL dob 적용
  const params = new URLSearchParams(location.search);
  const dobQ = params.get('dob');
  if(dobQ && /^\d{4}-\d{2}-\d{2}$/.test(dobQ)){
    yy.value = dobQ.slice(0,4); mm.value = dobQ.slice(5,7); dd.value = dobQ.slice(8,10);
    render(dobQ);
  }

  btn.addEventListener('click', ()=>{
    const y = yy.value.trim(), m = mm.value.trim(), d = dd.value.trim();
    if(y.length!==4 || m.length!==2 || d.length!==2){ alert('생년월일을 정확히 입력해 주세요.\n(예: 2001·08·15)'); return; }
    const dob = `${y}-${pad2(m)}-${pad2(d)}`;
    // 유효한 날짜 확인
    const t = new Date(dob);
    if(isNaN(t.getTime()) || t.getFullYear()!=y*1 || (t.getMonth()+1)!=m*1 || t.getDate()!=d*1){
      alert('유효한 날짜가 아니에요. 다시 확인해 주세요.'); return;
    }
    render(dob);
  });

  shareBtn.addEventListener('click', onShare);
}
main();
</script>
</body>
</html>
