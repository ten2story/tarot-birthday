function main(){
  // 세그먼트 입력 참조
  const yy = document.getElementById('yy');
  const mm = document.getElementById('mm');
  const dd = document.getElementById('dd');
  const btn = document.getElementById('calc');
  const shareBtn = document.getElementById('share');

  // 숫자만, maxlength 도달 시 다음으로 자동 포커스
  const segs = [yy, mm, dd];
  segs.forEach((el, i) => {
    el.addEventListener('input', () => {
      const max = parseInt(el.getAttribute('maxlength') || '0', 10);
      el.value = el.value.replace(/\D/g,'').slice(0, max);
      if (el.value.length === max && i < segs.length - 1) segs[i+1].focus();
    });
  });

  // URL 쿼리 반영(있다면)
  const params = new URLSearchParams(location.search);
  const dobQ = params.get('dob');  // yyyy-mm-dd 형식
  if(dobQ && /^\d{4}-\d{2}-\d{2}$/.test(dobQ)){
    yy.value = dobQ.slice(0,4);
    mm.value = dobQ.slice(5,7);
    dd.value = dobQ.slice(8,10);
    render(dobQ);
  }

  // 계산 버튼
  btn.addEventListener('click', ()=>{
    const y = yy.value.trim();
    const m = mm.value.trim();
    const d = dd.value.trim();
    if (y.length!==4 || m.length===0 || d.length===0){
      alert('생년월일을 정확히 입력해 주세요. (예: 2001-08-15)'); return;
    }
    const mm2 = m.padStart(2,'0');
    const dd2 = d.padStart(2,'0');
    const dob = `${y}-${mm2}-${dd2}`;

    // 유효한 날짜인지 간단 체크
    const t = new Date(dob);
    if (isNaN(t.getTime()) || t.getFullYear()!=+y || (t.getMonth()+1)!=+mm2 || t.getDate()!=+dd2){
      alert('유효한 날짜가 아니에요. 다시 확인해 주세요.'); return;
    }

    render(dob);
  });

  // 공유 버튼
  shareBtn.addEventListener('click', onShare);
}
